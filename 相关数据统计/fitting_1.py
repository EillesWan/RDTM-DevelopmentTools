import numpy as np
import matplotlib.pyplot as plt
from scipy import optimize
 
def func(x,w,h,k,a,b,c):#需要拟合的函数
    return np.exp(k*(a*np.sin(x+c)+b)/(x+w)+h)
    
# 拟合点
a = [7333, 17438, 23881, 23885, 31637, 44953, 62116, 79171, 97850, 116070, 133878, 151593, 169494, 187675, 206787, 230782, 256550, 281407, 304585, 325745, 345614, 364338, 382993, 400723, 417510, 432842, 447611, 461479, 474314, 486586, 496007, 505993, 512464, 527467, 540256, 546716, 552657, 559071, 565238, 573903, 589440, 601690, 605482, 608449, 611241, 614213, 619891, 634124, 645737, 648748, 652025, 654904, 658032, 663354, 676265, 686757, 690696, 694311, 698037, 702033, 707592, 718455, 728142, 732352, 736321, 740341, 744476, 750730, 762774, 773663, 778427, 783309, 788052, 792989, 798311, 805836, 818565, 830770, 840505, 845851, 850919, 857107, 867918, 877046, 881784, 886702, 891909, 897029, 904056, 916637, 927196, 932066, 936643, 941017, 945208, 951389, 961406, 966346, 970488, 974445, 978443, 982690, 988673, 1001457, 1015283, 1027347, 1038184, 1046593, 1050608, 1054787, 1060927, 1070265, 1074229, 1078014, 1082167, 1086434, 1092073, 1103645, 1113585, 1117004, 1120025, 1123028, 1125930, 1130260, 1140697, 1149986, 1152959, 1155657, 1158319, 1161026, 1165265, 1176039, 1176052, 1184643, 1187125, 1190004, 1194476, 1198956, 1211379, 1223917, 1233858, 1237669, 1241219, 1244524, 1247448, 1251500, 1261302, 1269977, 1272844, 1275610, 1278321, 1281348, 1285965, 1295935, 1304761, 1308338, 1311964, 1315603, 1319595, 1325262, 1335844, 1345486, 1351432, 1357982, 1365690, 1373435, 1382015, 1393342, 1403973, 1412133, 1420323, 1429492, 1439640, 1450747, 1462145, 1473061, 1482784, 1492356, 1501676, 1510921, 1519888, 1529509, 1539376, 1548468, 1557682, 1566822, 1576240, 1585931, 1596210, 1606759, 1616828, 1626413, 1636021, 1646216, 1656283, 1667220, 1678166, 1688595, 1699160, 1710231, 1720786, 1732211, 1744057, 1756110, 1767454, 1779446, 1791375, 1803025, 1814851, 1826623, 1838749, 1850388, 1862563, 1874767, 1886990, 1899326, 1911608, 1924011, 1935937, 1947457, 1958655, 1969704, 1981019, 1992958, 2004814, 2014878, 2023747, 2031003, 2034950, 2040035, 2050549, 2059352, 2062777, 2065704, 2068681, 2071758, 2077455, 2091544, 2102816, 2110946, 2113726, 2116778, 2119135, 2123160, 2132847, 2140570, 2142795, 2144770, 2146629, 2148553, 2152396, 2162782, 2171196, 2173435, 2175554, 2177584, 2179873, 2184616, 2197694, 2210290, 2221781, 2221807, 2232522, 2242446, 2251561, 2258937, 2262080, 2265168, 2267927, 2270518, 2273467, 2276569, 2281592, 2291662, 2300055, 2303215, 2306254, 2309367, 2312457, 2317450, 2328010, 2336806, 2340181, 2343504, 2346991, 2350380, 2355294, 2365220, 2373730, 2377362, 2381010, 2384745, 2388701, 2394456, 2406019, 2415848, 2420119, 2424489, 2428795, 2433211, 2439666, 2451296, 2461336, 2465587, 2469757, 2473781, 2477939, 2484250, 2496629, 2507334, 2512505, 2517810, 2523169, 2529598, 2534934, 2539892, 2543553, 2545780, 2547893, 2549584, 2551728, 2552869, 2554131, 2555305, 2556079, 2556090, 2557089, 2557828, 2558749, 2560171, 2561275, 2561882, 2562588, 2563280, 2564173, 2565380, 2567079, 2568364, 2569548, 2570710, 2571858, 2573075, 2574478, 2575899, 2577265, 2578519, 2579854, 2581275, 2582576, 2584199, 2585862, 2587395, 2588886, 2590412, 2591901, 2593415, 2595390, 2597082, 2598670, 2600250, 2601736, 2603067, 2604336, 2605637, 2606930, 2608261, 2609545, 2610809, 2612013, 2613254, 2614422, 2615674, 2616852, 2618072, 2619262, 2620482, 2621659, 2622801, 2623848, 2624894, 2625862, 2626743, 2627510, 2628286, 2629031, 2629868, 2630603, 2631086, 2631434, 2631711, 2631720, 2632074, 2632504, 2633246, 2633858, 2634085, 2634249, 2634487, 2634654, 2635041, 2635861]

x0 = list(range(len(a)))
y0 = a.copy()#[i-min(a) for i in a]
last = y0[0]
y0 = [i/(y0.index(i)+1) for i in y0]

funcArg, maparray= optimize.curve_fit(func, x0, y0, maxfev=500000)
w4, h4, k4, a4, b4, c4 = funcArg
x4 = np.arange(0, len(a), 0.01)
y4 = np.exp(k4*(a4*np.sin(x4+c4)+b4)/(x4+w4)+h4)

plt.figure()
plt.plot(x0[:], y0[:], 1.5, "#AB70FF")
plt.scatter(x0[:], y0[:], 2.5, "#121110")
# plt.scatter(25, 25, 25, "red")
plt.plot(x4, y4, "#FC3432")
plt.show()
